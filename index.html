<!-- Copyright Greg Abbott 2025 v2025_04_29 - all in one - minified-->
<html lang="en"><head><meta charset="UTF-8"><link rel="icon" href="data:;base64,iVBORw0KGgo="><style>/* c.css */
:root {color-scheme: light dark;--light: hsl(0, 0%, 100%);--dark: hsl(0, 0%, 0%);--base_x1: 1ch;--half_base_x1: .5ch;--bg: light-dark(var(--light), var(--dark));--fg: light-dark(var(--dark), var(--light));--border: 1px solid var(--fg);--line_height: 140%;--rad: 3px;--checkerboard: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHZpZXdCb3g9IjAgMCAyIDIiPjxwYXRoIGQ9Ik0wIDBoMXYxSDB6bTEgMWgxdjFIMXoiLz48L3N2Zz4=")}.gap {display: block;height: 1lh;}* {outline: none;font-family: system-ui, sans-serif;font-variant-ligatures: no-common-ligatures;line-height: var(--line_height);padding: 0;margin: 0;font-size: 15px;box-sizing: border-box;border: 0;color: var(--fg);background-color: transparent;text-rendering: optimizeSpeed;}.no_select {user-select: none;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;cursor: default;}@media (prefers-color-scheme: dark) {::-moz-selection {background: var(--light);color: var(--dark);}::selection {background: var(--light);color: var(--dark);}}@media (prefers-color-scheme: light) {::-moz-selection {background: var(--dark);color: var(--light);}::selection {background: var(--dark);color: var(--light);}}html,body {height: 100dvh;width: 100dvw;min-height: 100dvh;min-width: 100dvw;}body {background-color: var(--bg);color: var(--fg);display: flex;flex-direction: column;}main {display: flex;flex-direction: row;overflow: hidden;height: 100%;}#left {display: flex;position: relative;flex-direction: column;flex-shrink: 1;flex-grow: 0;flex-basis: auto;padding: var(--base_x1);}#right_side {flex-grow: 1;flex-shrink: 0;height: 100%;display: flex;flex-direction: column;padding: var(--base_x1);overflow: hidden;position: relative;#padder {width: auto;flex-grow: 1;position: relative;}}#item_kind_list {display: flex;flex-direction: column;gap: 2px;div {color: var(--dark);display: inline;width: auto;&.active {opacity: 1;}}}input[type='text'] {padding: 0 3px;border: var(--border)}fieldset {padding: 1ch;border: var(--border);}#file_input {border: 2px solid transparent;}#file_input.highlight {border: 2px solid var(--fg);}#left input:checked+label {border: var(--border);}#toolbar {display: flex;flex-direction: column;gap: 0;>b {padding: 0 var(--half_base_x1)}}.disabled {opacity: 0.5;cursor: not-allowed;pointer-events: none;}::-webkit-scrollbar {width: 1em;}::-webkit-scrollbar,::-webkit-scrollbar-button,::-webkit-scrollbar-track,::-webkit-scrollbar-track-piece,::-webkit-scrollbar-thumb,::-webkit-scrollbar-corner,::-webkit-resizer {background: var(--bg);}::-webkit-scrollbar-thumb {cursor: default;border: var(--border);}#canvas_container {overflow: hidden;position: absolute;top: 50%;box-sizing: border-box;left: 50%;transform-origin: center;border-radius: var(--rad);img {position: absolute;top: 0;left: 0;}}mark {background: yellow;}#tl_handle {cursor: nw-resize;}#tr_handle {cursor: nesw-resize;}#bl_handle {cursor: nesw-resize;}#br_handle {cursor: se-resize;}#handle_group {display: none;}#handle_group div {position: absolute;width: 15px;height: 15px;background-color: hsla(0, 100%, 50%, 0.00);transform: translate(-50%, -50%);}details {display: flex;flex-direction: column;}summary {cursor: default;font-weight: bold;}progress {appearance: none;-webkit-appearance: none;-moz-appearance: none;background: white;border: var(--border);height: var(--base_x1);border-radius: var(--rad);&::-webkit-progress-bar {background: var(--bg);border-radius: var(--rad);}&::-webkit-progress-value {background: var(--fg);}}#html_draw_over {height: 100%;width: 100%;display: block;position: absolute;top: 0;left: 0;table,.a_box {user-select: text;position: absolute;overflow: hidden;}}.split_lines div {position: absolute;background-color: black;}.split_lines div:hover {background-color: red !important;z-index: 2;}#html_draw_over .a_box {white-space: pre-wrap;position: absolute;font-family: system-ui;font-size: unset;border-radius: var(--rad);color: #808080;&:hover {border-color: var(--dark);}&.selected {border-color: red;}border: 2px solid #808080;}.a_box {background: hsla(0, 0%, 100%, 0.80);}#html_draw_over * td {background-color: hsla(150, 100%, 90%, 0.9);border: 1px solid black;}[data-kind="div"] {background: hsla(200, 100%, 90%, 0.9);}[data-kind="fieldset"] {background: hsla(225, 100%, 89%, 0.9);}[data-kind="textarea"] {background: hsla(270, 100%, 90%, 0.9);}[data-kind="li"] {background: hsla(320, 100%, 90%, 0.9);}[data-kind="img"] {background: hsla(160, 100%, 90%, 0.9);}[data-kind="pre"] {background: hsla(0, 0%, 96%, 0.9);}[data-kind="small"] {background: hsla(0, 0%, 90%, 0.9);}[data-kind="hr"] {background: hsla(220, 0%, 80%, .9);}[data-kind="h1"] {background: hsla(0, 100%, 90%, 0.9);}[data-kind="h2"] {background: hsla(20, 100%, 90%, 0.9);}[data-kind="h3"] {background: hsla(40, 100%, 90%, 0.9);}[data-kind="p"] {background: hsla(60, 100%, 90%, 0.9);}[data-kind="b"] {background: hsla(80, 95%, 88%, 0.9);}[data-kind="a"] {background: hsla(120, 100%, 90%, 0.9);}[data-should_not_ocr="true"] {opacity: .3;}.being_drawn {border: 2px dashed red !important;}svg {cursor: default;}header,footer,#notify,#ocr_progress_notice {box-sizing: border-box;min-height: calc(var(--base_x1) * 3);height: auto;border-top: var(--border);padding: var(--half_base_x1) var(--base_x1);text-align: center;}footer {border: none;display: flex;flex-direction: row;position: relative;font-size: small;text-align: left;align-items: center;overflow: hidden;z-index: 1;* {font-size: 10px;}}#notify,#ocr_progress_notice {position: fixed;width: 100%;display: flex;justify-content: center;align-items: center;bottom: 0px;z-index: 999999;left: 0;text-align: center;background-color: var(--bg);}#ocr_progress_notice {gap: 1ch;}.handle {fill: blue;cursor: nwse-resize;}#selectedRectPath {cursor: crosshair;}[popover]:not(:popover-open) {display: none;}body:has(:popover-open) {#hide_popover {display: block;}}#hide_popover {display: none;z-index: 3;background: var(--checkerboard);background-size: 2px;background-position: 0 0;width: 100dvw;height: 100dvh;position: fixed;top: 0;left: 0;}[popover] {display: flex;flex-direction: column;position: fixed;z-index: 9999999;left: 50%;transform: translateX(-50%);padding: 1ch;top: 2ch;width: 64ch;max-width: 90dvw;border: var(--border);background-color: var(--bg);}.hide {display: none !important;}#enable_js {z-index: 999;display: flex;position: fixed;top: 0;left: 0;width: 100dvw;height: 100dvh;background-color: var(--bg);color: var(--fg);align-items: center;justify-content: center;}#click_to_load:hover {color: var(--fg);}#click_to_load {cursor: pointer;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);text-align: center;width: 100%;height: 100%;align-content: center;z-index: 2;color: transparent;}#menu_bar {gap: 2px;display: flex;padding: 2px 0 0px 1ch;line-height: var(--line_height);& input[type=radio] {display: none;}& input[type=radio]:not(:checked)~.sub_menu_holder {display: none;}align-items: center;}label[for="close_sub_menu"] {display: block;z-index: 3;background: var(--checkerboard);background-size: 2px;background-position: 0 0;width: 100dvw;height: 100dvh;position: fixed;top: 0;left: 0;}#close_sub_menu:checked+label[for="close_sub_menu"] {display: none;}#name_to_save_as,#left label,#please_enable_js,[popover],#ocr_progress_notice,.menu_button,.sub_menu_holder {border-radius: var(--rad);}.sub_menu_holder,#toolbar {button,.button {width: 100%;}}[popover] pre {.button,button {padding: 0 3px;border: 1px dashed var(--fg);}}.button,button,.menu_button {border-radius: var(--rad);padding: 0px var(--half_base_x1);border: 1px solid transparent;display: inline-block;cursor: pointer;text-align: left;&:hover {border: 1px dashed var(--fg);}&:active {background: var(--fg);color: var(--bg);border: var(--border);border-color: var(--fg);}&.active {border: var(--border);}}hr {width: 100%;border-top: var(--border);margin: 2px 0;}.menu_item {position: relative;&:hover .sub_menu_holder {display: flex !important;}.menu_button {border: var(--border);border-color: transparent;display: block;margin-bottom: 2px;}.sub_menu_holder {display: flex;flex-direction: column;position: absolute;background: var(--bg);min-width: 150px;padding: 2px;z-index: 3;border: var(--border);input {padding: 0 5px;}& :is(a, label, span, button) {border-radius: var(--rad);border: 1px solid transparent;background-color: transparent;text-align: left;margin: 0px 0;display: block;padding: 0 var(--half_base_x1);line-height: var(--line_height);&:hover {cursor: pointer;border-color: var(--fg);}&:active {background: var(--fg);border-color: var(--fg);color: var(--bg);}}.no_click {&:hover,&:active {background-color: var(--bg);border-color: var(--bg);cursor: default;color: var(--fg);}}}}.menu_item>input:checked+.menu_button,.menu_item:hover .menu_button {border-color: var(--fg);}pre {white-space: pre-wrap;}</style><title>Chop - Split images</title></head><body><noscript><div id="enable_js">This page requires JavaScript to run.</div></noscript><div popover="" id="popover_license"><pre>By + Copyright Â© 2025 <a href="https://gregabbott.pages.dev">Greg Abbott</a>.
All rights reserved.
<!---->
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, 
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO 
THE WARRANTIES OF MERCHANTABILITY, 
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
ANY CLAIM, DAMAGES OR OTHER LIABILITY, 
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, 
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
<!---->
CREDITS
Uses <a href="https://github.com/naptha/tesseract.js?tab=Apache-2.0-1-ov-file#readme" title="See Tesseract License">Tesseract JS</a> for OCR</pre></div><div popover="" id="popover_about"><pre>How to use:
- Load an image (e.g. a screenshot, a scanned document, art).
- Draw boxes around content and areas of interest in the image.
- Optionally:
  - Use the 'Score' tool on a box to split it, or make a table.
  - Tag to a box to confirm the kind of content it holds.
  - Recognise English text in the area one or all boxes cover.
    - (When saving as HTML, image boxes use this as "alt" text.)
  - Copy recognised text from one or all boxes.
  - Save files based on the boxes you've drawn and tagged. Save:
    - All boxes as PNG image files. <a href="demo.gif"
    title="14 second demo 435KB animated .GIF">Demo</a>
    - All tables as JSON and CSV files.
    - The entire layout, with all elements, as an HTML page.
      - (This automatically runs OCR on any unprocessed boxes.)
- To learn what any button does, hover over it for a tool tip.

Written in Vanilla JavaScript.
</pre></div><div id="menu_bar" class="no_select"><input name="m_bar" id="close_sub_menu" type="radio" checked=""><label for="close_sub_menu"></label><div class="menu_item"><input hidden="" id="mm_about" name="m_bar" type="radio"><label class="menu_button" for="mm_about">Learn </label><fieldset role="presentation" class="sub_menu_holder"><button popovertarget="popover_about">About</button><button popovertarget="popover_license">Rights</button><a href="log.html">Log</a><span class="no_click">Version 2025_0429</span></fieldset></div><div class="menu_item"><input hidden="" id="mm_file" name="m_bar" type="radio"><label class="menu_button" for="mm_file">Save </label><fieldset role="presentation" class="sub_menu_holder"><input hidden="" id="file_input" type="file" accept="image/*"><div title="Prefix saved files with this name"><label class="no_click" for="name_to_save_as">Output Name</label><input id="name_to_save_as" type="text"></div><span id="save_sub_image_of_all_user_rects">Boxes as images</span><span id="save_sub_images_of_rects_marked_as_img" title="Save one image per box tagged as an image">Image boxes</span><span class="no_click"><b title="Work In Progress">WIP</b></span><span id="save_html" title="Page layout and tables">Page layout</span><span id="save_tables">Tables</span></fieldset></div><div class="menu_item"><input hidden="" id="mm_delete" name="m_bar" type="radio"><label class="menu_button" for="mm_delete">More</label><fieldset role="presentation" class="sub_menu_holder"><span id="detect_content_bounds" title="Detect the image content bounds and draw a box around it">Draw bounding box</span><span id="delete_all_rects_within_selected_rect" title="Delete all boxes entirely within the bounds of the active box">Zap boxes within</span></fieldset></div><div class="menu_item"><input hidden="" id="mm_mark" name="m_bar" type="radio"><label class="menu_button" for="mm_mark" title="Tag any active box to mark the kind of content it holds.">Tag</label><fieldset role="presentation" class="sub_menu_holder"><div id="item_kind_list"></div></fieldset></div></div><div id="hide_popover"></div><pre></pre><main><div id="left"><div id="toolbar" class="no_select"><b>Mode</b><div id="modes_list"></div><div class="gap"></div><b>Text</b><input hidden="" type="radio" name="text_align" id="align_text_left_radio"><label class="button" for="align_text_left_radio">Left</label><input hidden="" type="radio" name="text_align" title="Align text in the active box LEFT" id="align_text_center_radio"><label class="button" for="align_text_center_radio" title="Align text in the active box to the MIDDLE">Middle</label><input hidden="" type="radio" name="text_align" id="align_text_right_radio"><label class="button" for="align_text_right_radio" title="'Align text in the active box RIGHT">Right</label><div class="gap"></div><input hidden="" id="do_not_ocr_this_box_checkbox" type="checkbox"><label for="do_not_ocr_this_box_checkbox" class="button" title="If the active box exists to contains other boxes,
mark it as a 'holder' so the tool won't OCR it.
This avoids duplicated content in output files.">Holder</label></div></div><div id="right_side"><div id="click_to_load" class="no_select">Pick or drag an image here</div><div id="padder" class="no_select"><div id="canvas_container"><div id="img_holder"><img id="current_image" alt="" src=""></div><div id="html_draw_over"></div><div id="handle_group"><div id="tl_handle"></div><div id="tr_handle"></div><div id="bl_handle"></div><div id="br_handle"></div></div></div></div></div></main><footer><span><button popovertarget="popover_license">Â© 2025</button><a href="https://gregabbott.pages.dev">Greg Abbott</a></span></footer><div popover="" id="rect_to_grid_fields"><label>Cols: <input type="number" id="r2g_cols" name="cols" min="1" value="2"></label><label>Rows: <input type="number" id="r2g_rows" name="rows" min="2" value="1"></label><label>Gap: <input type="number" id="r2g_gap" name="gap" min="0" value="0"></label><button id="convert_rect_to_grid">Convert rect to grid</button></div><div id="notify" class="hide">Notification</div><div id="ocr_progress_notice" class="hide"> Reading text <progress min="0" max="100" value="20" id="ocr_progress_percent"></progress><span id="ocr_progress_update">asd</span></div><script>/* 
tesseract.min.6.0.0.js
j.js
 */
/*! For tesseract.js license information please see:
https://github.com/naptha/tesseract.js/?tab=Apache-2.0-1-ov-file#readme */
let g0;!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Tesseract=e():t.Tesseract=e()}(self,(()=>(()=>{var t={30:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var o=function(t){"use strict";var e,r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,a=Object.create(o.prototype),c=new A(n||[]);return i(a,"_invoke",{value:k(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var p="suspendedStart",d="suspendedYield",y="executing",g="completed",m={};function v(){}function b(){}function x(){}var w={};s(w,c,(function(){return this}));var _=Object.getPrototypeOf,L=_&&_(_(C([])));L&&L!==r&&o.call(L,c)&&(w=L);var E=x.prototype=v.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,a,c,l){var u=h(t[i],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"===n(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,l)}),(function(t){r("throw",t,c,l)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,l)}))}l(u.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function k(t,e,r){var n=p;return function(o,i){if(n===y)throw Error("Generator is already running");if(n===g){if("throw"===o)throw i;return N()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=j(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===p)throw n=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=y;var l=h(t,e,r);if("normal"===l.type){if(n=r.done?g:d,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=g,r.method="throw",r.arg=l.arg)}}}function j(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,j(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function C(t){if(t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}return{next:N}}function N(){return{value:e,done:!0}}return b.prototype=x,i(E,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:b,configurable:!0}),b.displayName=s(x,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,s(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},O(S.prototype),s(S.prototype,l,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),s(E,u,"Generator"),s(E,c,(function(){return this})),s(E,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=C,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}("object"===n(t=r.nmd(t))?t.exports:{});try{regeneratorRuntime=o}catch(t){"object"===("undefined"==typeof globalThis?"undefined":n(globalThis))?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},52:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),c=new k(n||[]);return i(a,"_invoke",{value:L(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var p={};function d(){}function y(){}function g(){}var m={};s(m,c,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(j([])));b&&b!==e&&r.call(b,c)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function o(i,a,c,l){var u=h(t[i],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==n(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,c,l)}),(function(t){o("throw",t,c,l)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return o("throw",t,c,l)}))}l(u.arg)}var a;i(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=h(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function E(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=g,i(x,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:y,configurable:!0}),y.displayName=s(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(_.prototype),s(_.prototype,l,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(x),s(x,u,"Generator"),s(x,c,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function i(t,e,r,n,o,i,a){try{var c=t[i](a),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function c(t){i(a,n,o,c,l,"next",t)}function l(t){i(a,n,o,c,l,"throw",t)}c(void 0)}))}}var c=r(738),l=function(){var t=a(o().mark((function t(e,r,n){var i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c(r,1,n);case 2:return i=t.sent,t.abrupt("return",i.recognize(e).finally(a(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.terminate();case 2:case"end":return t.stop()}}),t)})))));case 4:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),u=function(){var t=a(o().mark((function t(e,r){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c("osd",0,r);case 2:return n=t.sent,t.abrupt("return",n.detect(e).finally(a(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.terminate();case 2:case"end":return t.stop()}}),t)})))));case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}();t.exports={recognize:l,detect:u}},287:t=>{t.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},188:t=>{t.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}},491:t=>{t.exports={workerBlobURL:!0,logger:function(){}}},11:t=>{t.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}},13:(t,e,r)=>{var n=r(857),o=0;t.exports=function(t){var e=t.id,r=t.action,i=t.payload,a=void 0===i?{}:i,c=e;return void 0===c&&(c=n("Job",o),o+=1),{id:c,action:r,payload:a}}},695:function(t,e,r){function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var o=this;function i(){"use strict";i=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),c=new k(n||[]);return o(a,"_invoke",{value:L(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var p={};function d(){}function y(){}function g(){}var m={};s(m,c,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(j([])));b&&b!==e&&r.call(b,c)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function i(o,a,c,l){var u=h(t[o],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==n(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){i("next",t,c,l)}),(function(t){i("throw",t,c,l)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return i("throw",t,c,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=h(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function E(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:y,configurable:!0}),y.displayName=s(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(_.prototype),s(_.prototype,l,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(x),s(x,u,"Generator"),s(x,c,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e,r,n,o,i,a){try{var c=t[i](a),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,l,"next",t)}function l(t){c(i,n,o,a,l,"throw",t)}a(void 0)}))}}var u=r(13),s=r(86).log,f=r(857),h=0;t.exports=function(){var t=f("Scheduler",h),e={},r={},n=[];h+=1;var c=function(){return Object.keys(e).length},p=function(){if(0!==n.length)for(var t=Object.keys(e),o=0;o<t.length;o+=1)if(void 0===r[t[o]]){n[0](e[t[o]]);break}},d=function(e,c){return new Promise((function(f,h){var d=u({action:e,payload:c});n.push(function(){var t=l(i().mark((function t(l){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.shift(),r[l.id]=d,t.prev=2,t.t0=f,t.next=6,l[e].apply(o,[].concat(function(t){if(Array.isArray(t))return a(t)}(i=c)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[d.id]));case 6:t.t1=t.sent,(0,t.t0)(t.t1),t.next=13;break;case 10:t.prev=10,t.t2=t.catch(2),h(t.t2);case 13:return t.prev=13,delete r[l.id],p(),t.finish(13);case 17:case"end":return t.stop()}var i}),t,null,[[2,10,13,17]])})));return function(e){return t.apply(this,arguments)}}()),s("[".concat(t,"]: Add ").concat(d.id," to JobQueue")),s("[".concat(t,"]: JobQueue length=").concat(n.length)),p()}))},y=function(){var e=l(i().mark((function e(r){var n,o,a,l=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==c()){e.next=2;break}throw Error("[".concat(t,"]: You need to have at least one worker before adding jobs"));case 2:for(o=Array((n=l.length)>1?n-1:0),a=1;a<n;a++)o[a-1]=l[a];return e.abrupt("return",d(r,o));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var t=l(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object.keys(e).forEach(function(){var t=l(i().mark((function t(r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e[r].terminate();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n=[];case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{addWorker:function(r){return e[r.id]=r,s("[".concat(t,"]: Add ").concat(r.id)),s("[".concat(t,"]: Number of workers=").concat(c())),p(),r.id},addJob:y,terminate:g,getQueueLen:function(){return n.length},getNumWorkers:c}}},738:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var o=["logger","errorHandler"];function i(){"use strict";i=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof d?e:d,a=Object.create(i.prototype),c=new k(n||[]);return o(a,"_invoke",{value:L(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var p={};function d(){}function y(){}function g(){}var m={};s(m,c,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(j([])));b&&b!==e&&r.call(b,c)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function i(o,a,c,l){var u=h(t[o],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==n(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){i("next",t,c,l)}),(function(t){i("throw",t,c,l)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return i("throw",t,c,l)}))}l(u.arg)}var a;o(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){i(t,r,e,n)}))}return a=a?a.then(n,n):n()}})}function L(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=h(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function E(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=g,o(x,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:y,configurable:!0}),y.displayName=s(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(_.prototype),s(_.prototype,l,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(x),s(x,u,"Generator"),s(x,c,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=function(t){var e=function(t){if("object"!==n(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"===n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function f(t,e,r,n,o,i,a){try{var c=t[i](a),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){f(i,n,o,a,c,"next",t)}function c(t){f(i,n,o,a,c,"throw",t)}a(void 0)}))}}var p=r(898),d=r(13),y=r(86).log,g=r(857),m=r(287),v=r(250),b=v.defaultOptions,x=v.spawnWorker,w=v.terminateWorker,_=v.onMessage,L=v.loadImage,E=v.send,O=0;t.exports=h(i().mark((function t(){var e,r,n,c,u,f,v,S,k,j,P,T,A,C,N,F,M,I,R,G,D,H,W,Y,B,U,z,$,q,K,X,J,V,Z,Q=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Q.length>0&&void 0!==Q[0]?Q[0]:"eng",r=Q.length>1&&void 0!==Q[1]?Q[1]:m.LSTM_ONLY,n=Q.length>2&&void 0!==Q[2]?Q[2]:{},c=Q.length>3&&void 0!==Q[3]?Q[3]:{},u=g("Worker",O),f=p(l(l({},b),n)),v=f.logger,S=f.errorHandler,k=s(f,o),j={},P="string"==typeof e?e.split("+"):e,T=r,A=c,C=[m.DEFAULT,m.LSTM_ONLY].includes(r)&&!k.legacyCore,M=new Promise((function(t,e){F=t,N=e})),I=function(t){N(t.message)},(R=x(k)).onerror=I,O+=1,G=function(t){var e=t.id,r=t.action,n=t.payload;return new Promise((function(t,o){y("[".concat(u,"]: Start ").concat(e,", action=").concat(r));var i="".concat(r,"-").concat(e);j[i]={resolve:t,reject:o},E(R,{workerId:u,jobId:e,action:r,payload:n})}))},D=function(){return console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)")},H=function(t){return G(d({id:t,action:"load",payload:{options:{lstmOnly:C,corePath:k.corePath,logging:k.logging}}}))},W=function(t,e,r){return G(d({id:r,action:"FS",payload:{method:"writeFile",args:[t,e]}}))},Y=function(t,e){return G(d({id:e,action:"FS",payload:{method:"readFile",args:[t,{encoding:"utf8"}]}}))},B=function(t,e){return G(d({id:e,action:"FS",payload:{method:"unlink",args:[t]}}))},U=function(t,e,r){return G(d({id:r,action:"FS",payload:{method:t,args:e}}))},z=function(t,e){return G(d({id:e,action:"loadLanguage",payload:{langs:t,options:{langPath:k.langPath,dataPath:k.dataPath,cachePath:k.cachePath,cacheMethod:k.cacheMethod,gzip:k.gzip,lstmOnly:[m.DEFAULT,m.LSTM_ONLY].includes(T)&&!k.legacyLang}}}))},$=function(t,e,r,n){return G(d({id:n,action:"initialize",payload:{langs:t,oem:e,config:r}}))},q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eng",e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(C&&[m.TESSERACT_ONLY,m.TESSERACT_LSTM_COMBINED].includes(e))throw Error("Legacy model requested but code missing.");var o=e||T;T=o;var i=r||A;A=i;var c,l=("string"==typeof t?t.split("+"):t).filter((function(t){return!P.includes(t)}));return P.push.apply(P,function(t){if(Array.isArray(t))return a(t)}(c=l)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(c)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l.length>0?z(l,n).then((function(){return $(t,o,i,n)})):$(t,o,i,n)},K=function(){return G(d({id:arguments.length>1?arguments[1]:void 0,action:"setParameters",payload:{params:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}))},X=function(){var t=h(i().mark((function t(e){var r,n,o,a=arguments;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},n=a.length>2&&void 0!==a[2]?a[2]:{text:!0},o=a.length>3?a[3]:void 0,t.t0=G,t.t1=d,t.t2=o,t.next=8,L(e);case 8:return t.t3=t.sent,t.t4=r,t.t5=n,t.t6={image:t.t3,options:t.t4,output:t.t5},t.t7={id:t.t2,action:"recognize",payload:t.t6},t.t8=(0,t.t1)(t.t7),t.abrupt("return",(0,t.t0)(t.t8));case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=function(){var t=h(i().mark((function t(e,r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!C){t.next=2;break}throw Error("`worker.detect` requires Legacy model, which was not loaded.");case 2:return t.t0=G,t.t1=d,t.t2=r,t.next=7,L(e);case 7:return t.t3=t.sent,t.t4={image:t.t3},t.t5={id:t.t2,action:"detect",payload:t.t4},t.t6=(0,t.t1)(t.t5),t.abrupt("return",(0,t.t0)(t.t6));case 12:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),V=function(){var t=h(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null!==R&&(w(R),R=null),t.abrupt("return",Promise.resolve());case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_(R,(function(t){var e=t.workerId,r=t.jobId,n=t.status,o=t.action,i=t.data,a="".concat(o,"-").concat(r);if("resolve"===n)y("[".concat(e,"]: Complete ").concat(r)),j[a].resolve({jobId:r,data:i}),delete j[a];else if("reject"===n){if(j[a].reject(i),delete j[a],"load"===o&&N(i),!S)throw Error(i);S(i)}else"progress"===n&&v(l(l({},i),{},{userJobId:r}))})),Z={id:u,worker:R,load:D,writeText:W,readText:Y,removeFile:B,FS:U,reinitialize:q,setParameters:K,recognize:X,detect:J,terminate:V},H().then((function(){return z(e)})).then((function(){return $(e,r,c)})).then((function(){return F(Z)})).catch((function(){})),t.abrupt("return",M);case 34:case"end":return t.stop()}}),t)})))},954:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t,e,r){return(e=function(t){var e=function(t){if("object"!==n(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"===n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(30);var a=r(695),c=r(738),l=r(52),u=r(11),s=r(287),f=r(188),h=r(86).setLogging;t.exports=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({languages:u,OEM:s,PSM:f,createScheduler:a,createWorker:c,setLogging:h},l)},827:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}t.exports=function(t){var r={};return"undefined"!=typeof WorkerGlobalScope?r.type="webworker":"object"===("undefined"==typeof document?"undefined":e(document))?r.type="browser":"object"===("undefined"==typeof process?"undefined":e(process))&&(r.type="node"),void 0===t?r:r[t]}},857:t=>{t.exports=function(t,e){return"".concat(t,"-").concat(e,"-").concat(Math.random().toString(16).slice(3,8))}},86:function(t,e){var r=this,n=!1;e.logging=n,e.setLogging=function(t){n=t},e.log=function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];return n?console.log.apply(r,e):null}},898:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t,e,r){return(e=function(t){var e=function(t){if("object"!==n(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"===n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a="browser"===r(827)("type")?function(t){return new URL(t,window.location.href).href}:function(t){return t};t.exports=function(t){var e=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t);return["corePath","workerPath","langPath"].forEach((function(r){t[r]&&(e[r]=a(e[r]))})),e}},989:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return(e=function(t){var e=function(t){if("object"!==n(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return t+""}(t);return"symbol"===n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=r(330).rE,l=r(491);t.exports=i(i({},l),{},{workerPath:"https://cdn.jsdelivr.net/npm/tesseract.js@v".concat(c,"/dist/worker.min.js")})},250:(t,e,r)=>{var n=r(989),o=r(423),i=r(399),a=r(278),c=r(782),l=r(383);t.exports={defaultOptions:n,spawnWorker:o,terminateWorker:i,onMessage:a,send:c,loadImage:l}},383:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(){"use strict";r=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),c=new k(n||[]);return i(a,"_invoke",{value:L(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var p={};function d(){}function y(){}function g(){}var m={};s(m,c,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(j([])));b&&b!==n&&o.call(b,c)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,r){function n(i,a,c,l){var u=h(t[i],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==e(f)&&o.call(f,"__await")?r.resolve(f.__await).then((function(t){n("next",t,c,l)}),(function(t){n("throw",t,c,l)})):r.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,l)}))}l(u.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return a=a?a.then(o,o):o()}})}function L(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=h(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function E(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=g,i(x,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:y,configurable:!0}),y.displayName=s(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(_.prototype),s(_.prototype,l,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(x),s(x,u,"Generator"),s(x,c,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function n(t,e,r,n,o,i,a){try{var c=t[i](a),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function c(t){n(a,o,i,c,l,"next",t)}function l(t){n(a,o,i,c,l,"throw",t)}c(void 0)}))}}var i=function(t){return new Promise((function(e,r){var n=new FileReader;n.onload=function(){e(n.result)},n.onerror=function(t){var e=t.target.error.code;r(Error("File could not be read! Code=".concat(e)))},n.readAsArrayBuffer(t)}))},a=function(){var t=o(r().mark((function t(e){var n,c,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e,void 0!==e){t.next=3;break}return t.abrupt("return","undefined");case 3:if("string"!=typeof e){t.next=16;break}if(!/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)){t.next=8;break}n=atob(e.split(",")[1]).split("").map((function(t){return t.charCodeAt(0)})),t.next=14;break;case 8:return t.next=10,fetch(e);case 10:return c=t.sent,t.next=13,c.arrayBuffer();case 13:n=t.sent;case 14:t.next=43;break;case 16:if(!("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)){t.next=30;break}if("IMG"!==e.tagName){t.next=21;break}return t.next=20,a(e.src);case 20:n=t.sent;case 21:if("VIDEO"!==e.tagName){t.next=25;break}return t.next=24,a(e.poster);case 24:n=t.sent;case 25:if("CANVAS"!==e.tagName){t.next=28;break}return t.next=28,new Promise((function(t){e.toBlob(function(){var e=o(r().mark((function e(o){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(o);case 2:n=e.sent,t();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 28:t.next=43;break;case 30:if(!("undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)){t.next=39;break}return t.next=33,e.convertToBlob();case 33:return l=t.sent,t.next=36,i(l);case 36:n=t.sent,t.next=43;break;case 39:if(!(e instanceof File||e instanceof Blob)){t.next=43;break}return t.next=42,i(e);case 42:n=t.sent;case 43:return t.abrupt("return",new Uint8Array(n));case 44:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();t.exports=a},278:t=>{t.exports=function(t,e){t.onmessage=function(t){var r=t.data;e(r)}}},782:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(){"use strict";r=function(){return t};var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,a=Object.create(o.prototype),c=new k(n||[]);return i(a,"_invoke",{value:L(t,r,c)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var p={};function d(){}function y(){}function g(){}var m={};s(m,c,(function(){return this}));var v=Object.getPrototypeOf,b=v&&v(v(j([])));b&&b!==n&&o.call(b,c)&&(m=b);var x=g.prototype=d.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,r){function n(i,a,c,l){var u=h(t[i],t,a);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==e(f)&&o.call(f,"__await")?r.resolve(f.__await).then((function(t){n("next",t,c,l)}),(function(t){n("throw",t,c,l)})):r.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,l)}))}l(u.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new r((function(r,o){n(t,e,r,o)}))}return a=a?a.then(o,o):o()}})}function L(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=E(a,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=h(t,e,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function E(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=h(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function j(t){if(t){var e=t[c];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return y.prototype=g,i(x,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:y,configurable:!0}),y.displayName=s(g,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},w(_.prototype),s(_.prototype,l,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new _(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(x),s(x,u,"Generator"),s(x,c,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=j,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=o.call(i,"catchLoc"),l=o.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:j(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}function n(t,e,r,n,o,i,a){try{var c=t[i](a),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,o)}t.exports=function(){var t,e=(t=r().mark((function t(e,n){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.postMessage(n);case 1:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function c(t){n(a,o,i,c,l,"next",t)}function l(t){n(a,o,i,c,l,"throw",t)}c(void 0)}))});return function(t,r){return e.apply(this,arguments)}}()},423:t=>{t.exports=function(t){var e,r=t.workerPath,n=t.workerBlobURL;if(Blob&&URL&&n){var o=new Blob(['importScripts("'.concat(r,'");')],{type:"application/javascript"});e=new Worker(URL.createObjectURL(o))}else e=new Worker(r);return e}},399:t=>{t.exports=function(t){t.terminate()}},330:t=>{"use strict";t.exports={rE:"6.0.0"}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r(954)})()));const chop=t=>{g0=r();const e=[...document.querySelectorAll('[id]:not([id=""])')].reduce(((t,e)=>(t[e.id.trim()]=e,t)),{});function r(){return{table_count:0,live_box:null,rects_sub_image:new WeakMap,boxes_with_ocr_text:new WeakSet,current_mode_name:"none"}}function n(){let t=e.current_image,r=t.naturalWidth,n=t.naturalHeight;t.width=r,t.height=n,e.canvas_container.style.width=r+"px",e.canvas_container.style.height=n+"px",e.html_draw_over.style.height=n+"px",e.html_draw_over.style.width=r+"px"}function o(){const t=e.file_input.files[0];if(!t)return G(e.click_to_load),e.current_image.src="",e.current_image.style.width=0,e.current_image.style.height=0,void(g0=r());const o=new FileReader;o.onload=()=>{let r=e.current_image;r.src=o.result,r.onload=()=>{D(e.click_to_load),T("click",c,e.right_side),e.name_to_save_as.value=t.name,n(),l()}},o.readAsDataURL(t)}e.current_image.src&&n(),e.click_to_load.onclick=()=>e.file_input.click(),A("change",o,e.file_input),function(){let t=document.body;A("dragover",(function(t){t.preventDefault(),e.file_input.classList.add("highlight")}),t),A("dragleave",(function(t){t.preventDefault(),e.file_input.classList.remove("highlight")}),t),A("drop",(function(t){t.preventDefault(),e.file_input.classList.remove("highlight");let r=t.dataTransfer.files;r.length&&(e.file_input.files=r,o())}),t)}();let i=null,a=!1;function c(){0==e.current_image.width&&e.file_input.click()}function l(){var t;t=e.padder,a||(a=!0,requestAnimationFrame((()=>{a=!1;let r=e.canvas_container,n=e.current_image;if(!t||!n.complete||0===n.naturalWidth)return;let o=n.naturalWidth,c=n.naturalHeight,l=t.getBoundingClientRect(),u=l.width,s=l.height,f=Math.min(u/o,s/c);i!==f&&(i=f,r.style.transform=`translate(-50%, -50%) scale(${f})`)})))}A("resize",l,window),A("load",l,window);let u=null;function s(){let t=e.current_image.width/100,r=e.current_image.height/100,n=Math.max(t,r);return{box:N({x:n,y:n,w:e.current_image.width-2*n,h:e.current_image.height-2*n}),margin:n}}function f(t=g0.live_box){if(!t)return;let e=function(t){let e=t.reduce(((t,e)=>({min_x:null===t.min_x||e.x<t.min_x?e.x:t.min_x,min_y:null===t.min_y||e.y<t.min_y?e.y:t.min_y,max_x:null===t.max_x||e.x+e.width>t.max_x?e.x+e.width:t.max_x,max_y:null===t.max_y||e.y+e.height>t.max_y?e.y+e.height:t.max_y})),{min_x:null,min_y:null,max_x:null,max_y:null});return{x:e.min_x,y:e.min_y,width:e.max_x-e.min_x,height:e.max_y-e.min_y}}(d(v(t).canvas));return e.width>5&&e.height>5?(r={width:e.width+"px",height:e.height+"px",left:parseInt(t.style.left)+e.x+"px",top:parseInt(t.style.top)+e.y+"px"},n=t,Object.entries(r).forEach((([t,e])=>{n.style[t]=e})),U(),W(t),t):t;var r,n}function h(t){let e=t.data;for(let t=0;t<e.length;t+=4)e[t]=255-e[t],e[t+1]=255-e[t+1],e[t+2]=255-e[t+2];return t}function p(t){let e=function(t){let e=t.data;for(let t=0;t<e.length;t+=4){let r=.3*e[t]+.59*e[t+1]+.11*e[t+2];e[t]=e[t+1]=e[t+2]=r}return t}(t.getContext("2d").getImageData(0,0,t.width,t.height)),r=function(t,e=128){let r=t.data;for(let t=0;t<r.length;t+=4){let n=r[t]>e?255:0;r[t]=r[t+1]=r[t+2]=n}return t}(e,128),n=function(t,e=5){let{width:r,height:n,data:o}=t,i=new Uint8ClampedArray(o),a=Math.floor(e/2);for(let t=a;t<n-a;t++)for(let e=a;e<r-a;e++){let n=0;for(let i=-a;i<=a;i++)for(let c=-a;c<=a;c++)n=Math.max(n,o[4*((t+i)*r+(e+c))]);let c=4*(t*r+e);i[c]=i[c+1]=i[c+2]=n}return new ImageData(i,r,n)}(h(r),13);return h(n)}function d(t){return function(t){let{width:e,height:r,data:n}=t,o=[],i=new Set;function a(t,o){let a=[[t,o]],c=t,l=o,u=t,s=o;for(;a.length;){let[t,o]=a.pop(),f=4*(o*e+t);i.has(f)||255===n[f]||(i.add(f),c=Math.min(c,t),l=Math.min(l,o),u=Math.max(u,t),s=Math.max(s,o),t>0&&a.push([t-1,o]),t<e-1&&a.push([t+1,o]),o>0&&a.push([t,o-1]),o<r-1&&a.push([t,o+1]))}return{x:c,y:l,width:u-c,height:s-l}}for(let t=0;t<r;t++)for(let r=0;r<e;r++){let c=4*(t*e+r);0!==n[c]||i.has(c)||o.push(a(r,t))}return o}(p(t))}e.detect_content_bounds.onclick=()=>{let{box:t,margin:e}=s(),r=function(t){let e=v(t);return r(p(e.canvas),e.w,e.h);function r(t){let e=t.data,r=t.width,n=t.height,o=r,i=n,a=0,c=0;for(let t=0;t<n;t++)for(let n=0;n<r;n++){e[4*(t*r+n)]>128||(n<o&&(o=n),n>a&&(a=n),t<i&&(i=t),t>c&&(c=t))}return o<=a&&i<=c?{x:o,y:i,w:a-o,h:c-i}:null}}(t);Y(t);H(N({x:e+r.x,y:e+r.y,w:r.w,h:r.h}))};async function y(e,r){v(e);let n=await async function(e){try{u||(u=await t.createWorker("eng"));const{data:r}=await u.recognize(e);return r.text}catch(t){console.error("Error during OCR processing:",t)}}(g0.rects_sub_image.get(e).canvas);return e.textContent=n,g0.boxes_with_ocr_text.add(e),function(t){let e=t.offsetParent.getBoundingClientRect(),r=(t.getBoundingClientRect(),e.width/t.offsetParent.offsetWidth||1),n=e.height/t.offsetParent.offsetHeight||1,o=t.clientHeight/n,i=t.clientWidth/r,a=t.textContent.split("\n").length||1,c=Math.floor(o/a);t.style.fontSize=c+"px";for(;(t.scrollWidth/r>i||t.scrollHeight/n>o)&&c>1;)c--,t.style.fontSize=c+"px"}(e),e.textContent=n.trim(),"function"==typeof r?r(e):e}async function g(t){if(!e.current_image.src)return j("No image loaded");let r=t;if(0===r.length)return j("No boxes found");let n=r.length,o=n/100;e.ocr_progress_notice.classList.remove("hide");let i=1;for(let t of r)await y(t),e.ocr_progress_percent.value=Math.floor(i/o),e.ocr_progress_update.textContent=`(Done ${i} of ${n})`,i++;j("OCR'd boxes!"),D(e.ocr_progress_notice)}function m(t){let r=function(){let t=e.canvas_container,r=window.getComputedStyle(t).transform.match(/matrix\(([^)]+)\)/);return r?parseFloat(r[1].split(", ")[0]):1}(),n=e.current_image,o=n.getBoundingClientRect(),i=t.getBoundingClientRect(),a=(i.left-o.left)/r,c=(i.top-o.top)/r,l=i.width/r,u=i.height/r,s=document.createElement("canvas");s.width=l,s.height=u,s.getContext("2d").drawImage(n,a,c,l,u,0,0,l,u);let f={x:a,y:c,w:l,h:u,data:s.toDataURL(),canvas:s,rect:t};return g0.rects_sub_image.set(t,f),f}function v(t){return g0.rects_sub_image.has(t)?g0.rects_sub_image.get(t):m(t)}function b(t=e.html_draw_over){return[...t.getElementsByClassName("a_box")].filter((t=>"true"!==t.dataset.should_not_ocr))}function x(t){return b().filter((e=>e.dataset.kind===t))}function w(t){return t.sort(((t,e)=>{let r=t.getBoundingClientRect(),n=e.getBoundingClientRect();return r.top!==n.top?r.top-n.top:r.left-n.left})),t}function _(t){if(!e.current_image.src)return void j("The page lacks a big image to make sub images from");if(0===t.length)return j("No user-drawn boxes found");let r=[];w(t).forEach(((t,n)=>{v(t);let o=g0.rects_sub_image.get(t),i=function(t,e=2){return(t+"").padStart(e,"0")}(n+1);o.name=`${e.name_to_save_as.value} ${i}.png`,r.push(o)})),L($(r),"Sub-images.tar")}function L(t,e){const r=document.createElement("a");r.href=URL.createObjectURL(t),r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r)}function E(t,e){navigator.clipboard.writeText(t).then((()=>{"function"==typeof e&&e()})).catch((t=>{console.error("Failed to copy: ",t)}))}function O(t){return t.t=t.y,t.r=t.w+t.x,t.c=t.x+t.w/2,t.b=t.h+t.y,t.m=t.t+t.h/2,t.l=t.x,t.a=t.w*t.h,t.max=Math.max(t.w,t.h),t.min=Math.min(t.w,t.h),t}function S(t){return O({x:t.offsetLeft,y:t.offsetTop,w:t.offsetWidth,h:t.offsetHeight,el:t})}function k(t=g0.live_box){if(!g0.live_box)return;let e=t.querySelector(".split_lines");e||(e=document.createElement("div"),e.classList.add("split_lines"),e.style.position="absolute",e.style.top="0",e.style.left="0",t.appendChild(e),e.points={x:[],y:[]});const r="2px",n="0px",o=()=>{const t=document.createElement("div");return t.style.pointerEvents="none",t.style.display="none",e.appendChild(t),t},i=o(),a=o(),c=()=>{const e=t.getBoundingClientRect();return{rect:e,scale_x:t.offsetWidth/e.width,scale_y:t.offsetHeight/e.height,width:t.offsetWidth,height:t.offsetHeight}};let l=c();const u=t=>{i.style.width=l.width+"px",i.style.height=r,i.style.left=n,i.style.top=t+"px",i.style.display="block"},s=t=>{a.style.height=l.height+"px",a.style.width=r,a.style.top=n,a.style.left=t+"px",a.style.display="block"},f=()=>{i.style.display="none",a.style.display="none"},h=t=>(l=c(),{x:(t.clientX-l.rect.left)*l.scale_x,y:(t.clientY-l.rect.top)*l.scale_y}),p=(t,e)=>t<10?"left":t>l.width-10?"right":e<10?"top":e>l.height-10?"bottom":null,d=t=>e.points.y.some((e=>Math.abs(t-e)<=5)),y=t=>e.points.x.some((e=>Math.abs(t-e)<=5)),g=t=>{const o=document.createElement("div");o.style.width=l.width+"px",o.style.height=r,o.style.left=n,o.style.top=t+"px",e.appendChild(o),e.points.y.push(t)},m=t=>{const o=document.createElement("div");o.style.height=l.height+"px",o.style.width=r,o.style.top=n,o.style.left=t+"px",e.appendChild(o),e.points.x.push(t)};return A("mousemove",(t=>{const e=h(t),r=p(e.x,e.y),n=d(e.y),o=y(e.x);f(),"left"===r||"right"===r?u(e.y):"top"===r||"bottom"===r||n?s(e.x):o?u(e.y):(u(e.y),s(e.x))}),t),A("mouseleave",f,t),A("click",(t=>{const e=h(t),r=p(e.x,e.y),n=d(e.y),o=y(e.x);"left"===r||"right"===r?g(e.y):"top"===r||"bottom"===r||n?m(e.x):o?g(e.y):(g(e.y),m(e.x)),f()}),t),e}function j(t){g0.notification_timeout&&clearTimeout(g0.notification_timeout),e.notify.textContent=t,G(e.notify),g0.notification_timeout=setTimeout((()=>{D(e.notify)}),2500)}function P({cells:t,holder:r,is_a_table:n}){let o=null,i=null,a=null,c=null;n&&(o=e.html_draw_over.appendChild(document.createElement("table")),o.style.cssText=r.style.cssText,o.classList.remove("a_box"),i=o.appendChild(document.createElement("tbody")),g0.table_count++,o.id="table_"+g0.table_count),t.forEach(n?function(t){c!==t.row_n&&(c=t.row_n,a=document.createElement("tr"),i.appendChild(a)),t.tag="td",a.appendChild(N(t))}:function(t){e.html_draw_over.appendChild(N(t))}),Y(r)}function T(t,e,r){return r?(r.removeEventListener(t,e),r):r=>T(t,e,r)}function A(t,e,r){return r?(r.addEventListener(t,e),r):r=>A(t,e,r)}e.save_sub_images_of_rects_marked_as_img.onclick=()=>{_(x("img"))},e.save_sub_image_of_all_user_rects.onclick=()=>{_(b())},e.convert_rect_to_grid.onclick=()=>{e.rect_to_grid_fields.hidePopover(),function(){let t=g0.live_box;if(!t)return void console.log("Select a rectangle to turn into a grid");let r=confirm("Is it a table?"),n=parseInt(e.r2g_cols.value)||1,o=parseInt(e.r2g_rows.value)||1,i=parseInt(e.r2g_gap.value)||0,a=(s=t,O({x:parseInt(s.style.left),y:parseInt(s.style.top),w:parseInt(s.style.width),h:parseInt(s.style.height),el:s})),c=(a.w-(n-1)*i)/n,l=(a.h-(o-1)*i)/o,u=[];var s;for(let t=0;t<o;t++)for(let e=0;e<n;e++){let n=e*(c+i),o=t*(l+i);u.push({row_n:t,col_n:e,x:r?n:a.x+n,y:r?o:a.y+o,w:c,h:l})}P({cells:u,holder:t,is_a_table:r})}()};let C=[,{name:"Draw",gist:"Draw a box on the image.",fn:F((function(t){let r=e.html_draw_over;if(g0.started_a_two_click_action)!function(){let t=g0.started_a_two_click_action;g0.started_a_two_click_action=!1;let e=parseInt(t.style.width),n=parseInt(t.style.height);e<5&&n<5?r.removeChild(t):t.classList.remove("being_drawn");H(t)}();else{let o,i,a=r.getBoundingClientRect(),c=r.offsetWidth/a.width,l=r.offsetHeight/a.height,u=(t.clientX-a.left)*c,s=(t.clientY-a.top)*l,f=N({t:i,l:o,w:0,h:0});function n(t){let e=(t.clientX-a.left)*c,r=(t.clientY-a.top)*l,n=e-o,u=r-i;f.style.left=Math.min(o,e)+"px",f.style.top=Math.min(i,r)+"px",f.style.width=Math.abs(n)+"px",f.style.height=Math.abs(u)+"px"}g0.started_a_two_click_action=f,o=u,i=s,f.classList.add("being_drawn"),r.appendChild(f),A("mousemove",n,r),A("mouseup",(()=>{T("mousemove",n,r)}),r)}}),(function(t){let r=e.html_draw_over,n=r.getBoundingClientRect();document.body.style.userSelect="none";let o=r.offsetWidth/n.width,i=r.offsetHeight/n.height,a=(t.clientX-n.left)*o,c=(t.clientY-n.top)*i,l=N({t:c,l:a,w:0,h:0});l.classList.add("being_drawn");let u=t=>{let e=(t.clientX-n.left)*o,r=(t.clientY-n.top)*i,u=e-a,s=r-c;l.style.left=Math.min(a,e)+"px",l.style.top=Math.min(c,r)+"px",l.style.width=Math.abs(u)+"px",l.style.height=Math.abs(s)+"px"},s=t=>{let e=parseInt(l.style.width),n=parseInt(l.style.height);e<5&&n<5?r.removeChild(l):l.classList.remove("being_drawn"),document.body.style.userSelect="auto",T("mousemove",u,r),T("mouseup",s,r),H(l)};A("mousemove",u,r),A("mouseup",s,r)})),on:"mousedown"},{name:"Pick",gist:"Click a box to activate, move, or resize it.",fn:F((function(t){t.target.classList.contains("a_box")?H(t.target):B()}),(function(t){if(t.target!==g0.live_box)return;let r,n,o=e.html_draw_over,i=o.getBoundingClientRect(),a=o.offsetWidth/i.width,c=o.offsetHeight/i.height;g0.live_box&&t.target===g0.live_box&&(r=(t.clientX-i.left)*a-g0.live_box.offsetLeft,n=(t.clientY-i.top)*c-g0.live_box.offsetTop,A("mousemove",l,o),A("mouseup",(function t(){T("mousemove",l,o),T("mouseup",t,o),W(g0.live_box)}),o));function l(t){if(g0.live_box&&1===t.buttons){let e=(t.clientX-i.left)*a-r,l=(t.clientY-i.top)*c-n,u=g0.live_box.offsetWidth,s=g0.live_box.offsetHeight;g0.live_box.style.left=Math.max(0,Math.min(o.offsetWidth-u,e))+"px",g0.live_box.style.top=Math.max(0,Math.min(o.offsetHeight-s,l))+"px",U()}}})),on:"mousedown"},{name:"Trim",gist:"Shrink a box to fit the content within.",fn:function(t){t.target.classList.contains("a_box")?f(t.target):confirm("Shrink all boxes to fit (No undo)")&&b().forEach(f)}},{name:"Score",gist:"Add 'score' lines to the selected box, to tell the tool how and where to split it. Then click outside of the box to perform the split. The tool will offer to make a table or sub-boxes. NaNand click outside of the selected box, a form appears to instruct the tool how to split the box: into N evenly sized columns, and N evenly sized rows.",fn2:k,fn:function(t){g0.live_box?t.target===g0.live_box||g0.live_box.contains(t.target)||function(){if(g0.live_box.querySelector(".split_lines").children.length>2){if(!confirm("Split box at score lines?"))return;!function(){let t=g0.live_box;if(!t)return void console.log("Select a rectangle to turn into a grid");let e=t.querySelector(".split_lines");if(!e)return;let r=confirm("Is it a table?"),n=e.points||function(t){return[...t.querySelectorAll("div")].reduce(((t,e)=>{if("none"===e.style.display)return t;let r=parseFloat(e.style.left)||0,n=parseFloat(e.style.top)||0;return r&&t.x.push(r),n&&t.y.push(n),t}),{x:[],y:[]})}(e),o=S(t),i=[0,...n.x.sort(((t,e)=>t-e)),o.w],a=[0,...n.y.sort(((t,e)=>t-e)),o.h],c=[];for(let t=0;t<a.length-1;t++)for(let e=0;e<i.length-1;e++){let n=i[e],l=a[t];c.push({x:r?n:o.x+n,y:r?l:o.y+l,w:i[e+1]-n,h:a[t+1]-l,row_n:t,col_n:e})}P({cells:c,holder:t,is_a_table:r}),e.remove()}(g0.live_box)}else e.rect_to_grid_fields.showPopover(),e.r2g_cols.focus()}():t.target.classList.contains("a_box")?(H(t.target),k()):j("Activate any box to use score mode")}},{name:"Join",gist:"Click multiple boxes to MERGE them.",fn:function(t){if(!g0.live_box){if(!t.target.classList.contains("a_box"))return;H(t.target)}if(!(t.target.classList.contains("a_box")&&t.target!==g0.live_box))return;let e=function(t,e){let r=S(t),n=S(e),o=Math.min(r.l,n.l),i=Math.min(r.t,n.t),a=Math.max(r.r,n.r),c=Math.max(r.b,n.b);return{x:o,y:i,t:i,l:o,b:c,r:a,w:a-o,h:c-i}}(g0.live_box,t.target),r=N({x:e.x,y:e.y,w:e.w,h:e.h});g0.live_box.insertAdjacentElement("afterend",r),Y(g0.live_box),t.target.remove(),H(r)}},{name:"Zap",gist:"Click a box to DELETE it.",fn:function(t){t.target.classList.contains("a_box")?Y(t.target):function(){let t=[...e.html_draw_over.getElementsByClassName("a_box")];t.length<1||confirm("Delete ALL boxes? (No undo)")&&t.forEach(Y)}()}},{name:"Read",gist:"Click a box to run OCR* on the image area it covers. The tool only attempts to read English text in images. *OCR stands for optical character recognition.",fn:async function(t){t.target.classList.contains("a_box")?await y(t.target):confirm("OCR the image area each box covers?")&&g(b())}},{name:"Clip",gist:"Click a box to COPY any text it contains. If the tool hasn't previously processed a box, it automatically runs OCR on the image area it covers.",fn:function(t){if(t.target.classList.contains("a_box")){let e=t.target.textContent.trim();e.length>0?(E(e),j("Copied")):y(t.target,(t=>E(t.textContent,(()=>j("Copied!")))))}else{if(!confirm("Copy OCR'd text in all boxes?"))return;E(w(b()).reduce(((t,e)=>{let r=e.textContent.trim();return r.length>0&&t.push(r),t}),[]).join("\n\n"),(()=>j("Copied all OCR'd text in all boxes")))}}}];function N({x:t,y:r,t:n,l:o,w:i,h:a,id:c,tag:l="div",classes:u}){let s=document.createElement(l);return s.style.left=(o||t)+"px",s.style.top=(n||r)+"px",s.style.width=i+"px",s.style.height=a+"px",u?s.classList.add("a_box",...u):s.classList.add("a_box"),c&&(s.id=c),e.html_draw_over.appendChild(s),s}function F(t,r){return n=>{let o=n.clientX,i=n.clientY;const a=e.html_draw_over;A("mouseup",u,a);let c=setTimeout((()=>{A("mousemove",l,a)}),100);function l(t){clearTimeout(c),(Math.abs(t.clientX-o)>3||Math.abs(t.clientY-i)>3)&&(T("mousemove",l,a),r(n),T("mouseup",u,a))}function u(e){clearTimeout(c),T("mousemove",l,a),T("mouseup",u,a),t(e)}}}function M(){I.forEach((t=>{t.classList.remove("active")}))}C.forEach((function(t){let r=e.modes_list.appendChild(document.createElement("div")),n=r.appendChild(document.createElement("input"));n.type="radio",n.name="modes_list",n.hidden=!0,n.id="mode_"+t.name.toLowerCase();let o=r.appendChild(document.createElement("label"));o.textContent=t.name,o.setAttribute("for",n.id),o.classList.add("button"),t.gist&&(o.title=t.gist);t.radio=n,o.onclick=()=>function(t){if(g0.current_mode_name===t.name)return;g0.current_mode_name=t.name,void C.forEach((t=>{t.radio.checked=!1,t.fn&&T(t.on||"click",t.fn,e.html_draw_over)})),t.fn&&A(t.on||"click",t.fn,t.of||e.html_draw_over);t.fn2&&t.fn2()}(t)})),A("click",(function(){if(!g0.live_box)return;let t=g0.live_box;(function(t,e){let r=S(t);return[...e.getElementsByClassName("a_box")].filter((t=>{let{x:e,y:n,w:o,h:i}=S(t);return e>=r.x&&n>=r.y&&e+o<r.x+r.w&&n+i<r.y+r.h}))})(t,e.html_draw_over).forEach(Y),H(t)}),e.delete_all_rects_within_selected_rect);let I=[],R={};function G(t){return t.classList.remove("hide"),t}function D(t){return t.classList.add("hide"),t}function H(t){if(t==g0.live_box)return;g0.live_box&&g0.live_box.classList.remove("selected"),g0.live_box=t,g0.live_box.classList.add("selected");let r=t.style.textAlign||"left";e[`align_text_${r}_radio`].click();let n="true"===t.dataset?.should_not_ocr;return e.do_not_ocr_this_box_checkbox.checked=n,U(),e.handle_group.style.display="block",function(){if(M(),!g0.live_box)return;let t=R[(e=g0.live_box,e.dataset.kind||"")];var e;t&&t.classList.add("active")}(),t}function W(t){g0.rects_sub_image.delete(t)}function Y(t){t.remove(),W(t),B()}function B(){g0.live_box&&(g0.live_box.classList.remove("selected"),g0.live_box=null),e.handle_group.style.display="none"}function U(){if(!g0.live_box)return;let t=g0.live_box.offsetLeft,r=g0.live_box.offsetTop,n=g0.live_box.offsetWidth,o=g0.live_box.offsetHeight;[{i:"tl",x:t,y:r,dx:-1,dy:-1},{i:"tr",x:t+n,y:r,dx:1,dy:-1},{i:"bl",x:t,y:r+o,dx:-1,dy:1},{i:"br",x:t+n,y:r+o,dx:1,dy:1}].forEach((t=>{let r=e[t.i+"_handle"];r&&(r.style.left=t.x+"px",r.style.top=t.y+"px",r.dataset.x=t.dx,r.dataset.y=t.dy)}))}function z(t){let r=!0,n=t.target;function o(t){if(!(g0.live_box&&r&&n))return;let o=e.html_draw_over,i=o.getBoundingClientRect(),a=o.offsetWidth/i.width,c=o.offsetHeight/i.height,l=(t.clientX-i.left)*a,u=(t.clientY-i.top)*c,s=+n.dataset.x,f=+n.dataset.y,h=g0.live_box.offsetLeft,p=g0.live_box.offsetTop,d=g0.live_box.offsetWidth,y=g0.live_box.offsetHeight,g=h,m=p,v=d,b=y;-1===s?(g=l,v=h+d-l):1===s&&(v=l-h),-1===f?(m=u,b=p+y-u):1===f&&(b=u-p),v<1&&(g=h+d-1,v=1),b<1&&(m=p+y-1,b=1),g0.live_box.style.left=g+"px",g0.live_box.style.top=m+"px",g0.live_box.style.width=v+"px",g0.live_box.style.height=b+"px",U()}A("mousemove",o,document),A("mouseup",(function t(){r=!1,n=null,T("mousemove",o,document),T("mouseup",t,document),W(g0.live_box),document.body.style.userSelect="auto"}),document),document.body.style.userSelect="none"}function $(t,e=""){function r(t){const e=atob(t.split(",")[1]),r=e.length,n=new Uint8Array(r);for(let t=0;t<r;t++)n[t]=e.charCodeAt(t);return n}function n(t,e,r){const n=new TextEncoder,o=new Uint8Array(512),i=n.encode(t);o.set(i.slice(0,100),0);const a=e.toString(8).padStart(11,"0")+"\0";o.set(n.encode(a),124),o.set(n.encode(Math.floor(new Date(r).getTime()/1e3).toString(8).padStart(11,"0")+"\0"),136),o.set(n.encode("0000777\0"),100),o.set(n.encode("0000000\0"),108),o.set(n.encode("0000000\0"),116),o.set(n.encode("ustar  \0"),257);const c=o.reduce(((t,e)=>t+e),0)+256;return o.set(n.encode(c.toString(8).padStart(6,"0")+"\0 "),148),o}const o=new TextEncoder;let i=[];for(const{name:a,data:c,date:l,path:u=""}of t){let t=c.startsWith("data:image/")?r(c):o.encode(c);const s=e?`${e}/${u}${a}`:`${u}${a}`,f=l?new Date(l):new Date;i.push(n(s,t.length,f),t),i.push(new Uint8Array((512-t.length%512)%512))}return i.push(new Uint8Array(512),new Uint8Array(512)),new Blob(i,{type:"application/x-tar"})}function q(t){let e=Array.from(t.children).sort(((t,e)=>{let r=parseFloat(t.style.top)||0,n=parseFloat(e.style.top)||0;return r!==n?r-n:(parseFloat(t.style.left)||0)-(parseFloat(e.style.left)||0)}));e.forEach((e=>t.appendChild(e))),e.forEach((t=>{t.children.length&&q(t)}))}function K(t=new Date){const e=["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],r=["Y","M","d","h","m","s","u"].reduce(((r,n,o)=>{return r[n]=(t[i="get"+e[o]]()+("getMonth"===i)+"").padStart("getMilliseconds"===i?3:2,"0"),r;var i}),{});return r.c=r.Y.substring(0,2),r.y=r.Y.substring(2),r}function X(t=new Date){let e=K(t);return"Y_Md_hm".split("").map((t=>e[t]||t)).join("")}[["Image","img"],["Box","div"],["Fieldset","fieldset"],["Textarea","textarea"],["List Item","li"],["Pre-formatted","pre"],["Small","small"],["Horizontal Rule","hr"],["h1"],["h2"],["h3"],["Paragraph","p"],["Bold","b"],["Link","a"]].forEach((t=>{let r=document.createElement("div");r.classList.add("button");let n=2==t.length?t[1]:t[0],o=t[0];r.dataset.kind=n,r.innerText=o,r.onclick=()=>{var t,e;g0.live_box&&(M(),t=g0.live_box,e=n,t.dataset.kind=e,r.classList.add("active"))},I.push(r),R[n]=r,e.item_kind_list.appendChild(r)})),A("mousedown",z,e.tl_handle),A("mousedown",z,e.tr_handle),A("mousedown",z,e.bl_handle),A("mousedown",z,e.br_handle),A("click",(async function(){let t=X(),r=et();q(e.html_draw_over),await rt(b());let n=[];x("img").forEach((t=>{v(t),n.push(g0.rects_sub_image.get(t));let e=n.length-1;n[e].name=e+".png"}));let o=e.html_draw_over.cloneNode(!0),i=[];o.querySelectorAll(".a_box").forEach((t=>{"img"===t.dataset.kind&&function(t){let e=document.createElement("img");t.insertAdjacentElement("afterend",e),e.style.cssText=t.style.cssText,e.src=n[i.length].data,t.textContent.length>0&&(e.alt=function(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},r=t=>e[t];return(""+t).replace(/[&<>"']/g,r)}(t.textContent)),t.remove(),i.push(e)}(t)})),Q(o),function(t,e=!0,r=1){let n=parseFloat(getComputedStyle(document.documentElement).fontSize)*(96/2.54)/16,o=21*n*(29.7*n),i=parseFloat(t.style.width)||t.offsetWidth,a=parseFloat(t.style.height)||t.offsetHeight;function c(t,n){let o=(parseFloat(t.style.width)||t.offsetWidth)*n,i=(parseFloat(t.style.height)||t.offsetHeight)*n,a=(parseFloat(t.style.left)||0)*n,l=(parseFloat(t.style.top)||0)*n,u=(parseFloat(t.style.fontSize)||parseFloat(getComputedStyle(t).fontSize)||0)*n;if(e){let t=r;o=Math.round(o/t)*t,i=Math.round(i/t)*t,a=Math.round(a/t)*t,l=Math.round(l/t)*t,u=Math.round(u/t)*t}Object.assign(t.style,{width:o+"px",height:i+"px",left:a+"px",top:l+"px",fontSize:Math.max(5,u)+"px"}),[...t.children].forEach((t=>c(t,n)))}c(t,Math.sqrt(o/(i*a)))}(o),function(t){return e(t),a(t),t;function e(t){let e=[...t.children],i=new Map;e.forEach((t=>{let n=null,o=parseFloat(t.style.left)||0,a=parseFloat(t.style.top)||0,c=parseFloat(t.style.width)||t.offsetWidth,l=parseFloat(t.style.height)||t.offsetHeight,u=o+c,s=a+l;e.forEach((e=>{if(e!==t){let t=parseFloat(e.style.left)||0,i=parseFloat(e.style.top)||0,c=parseFloat(e.style.width)||e.offsetWidth,l=parseFloat(e.style.height)||e.offsetHeight;o>=t&&a>=i&&u<=t+c&&s<=i+l&&(n&&!r(n,e)||(n=e))}})),n&&(i.has(n)||i.set(n,[]),i.get(n).push(t))})),[...i.keys()].sort(((t,e)=>n(e)-n(t))).forEach((e=>{let r=i.get(e);r.sort(((t,e)=>{let r=parseFloat(t.style.top)||0,n=parseFloat(e.style.top)||0,o=parseFloat(t.style.left)||0,i=parseFloat(e.style.left)||0;return r-n||o-i})),r.forEach((r=>{if(t.contains(r)&&!r.contains(e)){let t=parseFloat(r.style.left)||0,n=parseFloat(r.style.top)||0,o=t-(parseFloat(e.style.left)||0),i=n-(parseFloat(e.style.top)||0);r.style.left=o+"px",r.style.top=i+"px",e.appendChild(r)}})),o(e,r)}))}function r(t,e){let r=parseFloat(t.style.left)||0,n=parseFloat(t.style.top)||0,o=r+(parseFloat(t.style.width)||t.offsetWidth),i=n+(parseFloat(t.style.height)||t.offsetHeight),a=parseFloat(e.style.left)||0,c=parseFloat(e.style.top)||0,l=parseFloat(e.style.width)||e.offsetWidth,u=parseFloat(e.style.height)||e.offsetHeight;return a>=r&&c>=n&&a+l<=o&&c+u<=i}function n(t){let e=0;for(;t.parentElement;)e++,t=t.parentElement;return e}function o(t,e){if(e.length<2)return;let r=e.some(((t,e,r)=>r.some((e=>t!==e&&i(t,e)))));t.classList.remove("row","col"),r?t.classList.add("row"):t.classList.add("col")}function i(t,e){let r=parseFloat(t.style.top)||0,n=r+(parseFloat(t.style.height)||t.offsetHeight),o=parseFloat(e.style.top)||0,i=o+(parseFloat(e.style.height)||e.offsetHeight);return!(n<=o||r>=i)}function a(t){let e=[...t.children],r=new Set;e.forEach(((t,n)=>{if(r.has(t))return;let o=[t],i=parseFloat(t.style.top)||0,a=parseFloat(t.style.height)||t.offsetHeight;if(e.slice(n+1).forEach((t=>{if(r.has(t))return;let e=parseFloat(t.style.top)||0,n=parseFloat(t.style.height)||t.offsetHeight;!(i+a<=e||e+n<=i)&&o.push(t)})),o.length>1){let t=o.reduce(((t,e)=>(parseFloat(e.style.left)||0)<(parseFloat(t.style.left)||0)?e:t),o[0]),e=document.createElement("div");e.className="row",e.style.position="absolute",e.style.left=t.style.left,e.style.top=t.style.top,t.insertAdjacentElement("afterend",e),o.forEach((t=>{let n=parseFloat(t.style.left)-parseFloat(e.style.left),o=parseFloat(t.style.top)-parseFloat(e.style.top);t.style.left=n+"px",t.style.top=o+"px",e.appendChild(t),r.add(t)}))}}))}}(o),function(t,e){e.forEach((e=>t.style.removeProperty(e)))}(o,["left","top","font-size"]);let a=[];function c({div:e,style:n=""}){return`\x3c!-- Made: ${t} --\x3e\n<!DOCTYPE html><html lang=en><meta charset=UTF-8><head>`+(n.trim().length>0?`<style>${n}</style>`:"")+`<title>${r}</title></head><body>\n${e}\n</body>\n</html>`.replace("html_draw_over","page")}let l=c({div:o.outerHTML,style:V});i.length>0&&a.push({name:r+" INLINE .html",data:l});let u="\x3c!--__TEMP ",s=" TEMP__--\x3e",f=o.cloneNode(!0);i.forEach(((t,e)=>{a.push(n[e]),t.removeAttribute("src"),t.outerHTML=u+t.outerHTML.replace("<img ",`<img src="${n[e].name}"`)+s})),a.push({data:c({div:f.outerHTML,style:V}).replaceAll(u,"").replaceAll(s,""),name:r+".html"}),function(){let t=f.cloneNode(!0);t.querySelectorAll("*").forEach((t=>{t.removeAttribute("style");for(let e of[...t.attributes])e.name.startsWith("data-")&&t.removeAttribute(e.name);t.classList.forEach((e=>{"row"!==e&&"col"!==e&&t.classList.remove(e)}))})),a.push({name:r+" flex.html",data:c({div:t.outerHTML,style:J})})}(),function(){let t=(new DOMParser).parseFromString(l,"text/html");Z(t.body),a.push({name:r+" plain.html",data:c({div:t.body.innerHTML,style:tt})})}(),(await ot()).forEach((t=>a.push(t))),L($(a),t+" "+r+" HTML.tar"),j("Saved Page Layout")}),e.save_html);let J="body {\nbackground-color: black;\nmargin: 0;\nmin-width: 100dvw;\nmin-height: 100dvh;\n}\n* {\nfont-family: sans-serif;\nbox-sizing: border-box;\nfont-size: 15px;\n}\n#page {\nbackground-color: hsl(0, 0%, 98%);\npadding: 8ch;\n/*min-width: 64ch;\nmax-width: min(80ch, 100%);*/\nmargin: 0 auto;\n/*justify-content: space-between;*/\n}\n#page,\n.col,\n.row {\ndisplay: flex;\ngap: 1ch;\n}\n#page{\ngap:1em;\n}\nhr {\n  border: none;\n  display: block;\n  min-height: 1px;\n  min-width: 100%;\n  background:black;\n}\n.col,#page {\nflex-direction: column;\n}\ntable,\n.row {\nwidth: 100%;\n}\n.row {\nflex-direction: row;\n}\n.row>* {\nflex: 1;\nmargin-bottom: 1ch;\n}\ntable{\n  border-collapse: collapse;\n  table-layout: fixed;\n}\ntd,th {\n  border: 1px solid #000;\n}\ndiv:not(.row):not(.col) {\nwhite-space: pre-wrap;\n}",V=":root {\n  color-scheme: light dark;\n  --light: hsl(0, 0%, 100%);\n  --dark: hsl(0, 0%, 0%);\n  --base_x1: 1ch;\n  --half_base_x1: .5ch;\n  --bg: light-dark(var(--light), var(--dark));\n  --fg: light-dark(var(--dark), var(--light));\n  --border: 1px solid var(--fg);\n  --line_height: 120%;\n  --sans: system-ui;\n  --monospace: monospace;\n  --page_padding:2cm;\n}\n* {\n  outline: none;\n  font-family: var(--sans);\n  font-variant-ligatures: no-common-ligatures;\n  line-height: var(--line_height);\n  padding: 0;\n  margin: 0;\n  box-sizing: border-box;\n  border: 0;\n  color: var(--dark);\n  background-color: transparent;\n}\nhtml,body {\n  max-width: 100dvw;\n  width: 100dvw;\n  min-width: 100dvh;\n}\nbody{\n  background-color: var(--dark);\n  display: flex;\n  flex-direction: column;\n}\n#page {\n  background-color: var(--light);\n  margin: 0 auto;\n  position: relative;\n}\nhr {\n  width: 100%;\n  max-height: 1px;\n  display: block;\n  background-color: var(--fg);\n}\n#page * {\n  position: absolute;\n   white-space: pre-wrap;\n}";function Z(t){t&&t instanceof Element&&(Array.from(t.attributes).forEach((e=>t.removeAttribute(e.name))),Array.from(t.childNodes).forEach((t=>{if(t.nodeType===Node.ELEMENT_NODE){Z(t);let e=!["BR","HR"].includes(t.tagName),r=t?.textContent?.trim()?.length+t?.value?.trim().length==0;e&&r&&!t.children.length&&t.remove()}else t.nodeType===Node.TEXT_NODE&&0==t.textContent.trim().length&&t.remove()})))}function Q(t){if(t.classList.remove("a_box"),t.classList.remove("selected"),0==t.classList.length&&t.removeAttribute("class"),void 0!==t.dataset.should_not_ocr&&(!function(t,e){e.forEach((e=>delete t.dataset[e]))}(t,["should_not_ocr"]),t.textContent=""),t.dataset.kind&&t.tagName.toLowerCase()!==t.dataset.kind){"p"===t.dataset.kind&&(t.textContent=t.textContent.replaceAll("\r\n","\n").replaceAll("\r","\n").replace(/\n+[ \t]*\n+/g,"").replaceAll("\n"," ").replaceAll("  "," ").replaceAll("","\n\n"));let e=document.createElement(t.dataset.kind);for(Array.from(t.attributes).forEach((t=>e.setAttribute(t.name,t.value))),function(t){Object.keys(t.dataset).forEach((e=>delete t.dataset[e]))}(e),"textarea"==t.dataset.kind&&(e.value=t.textContent);t.firstChild;)e.appendChild(t.firstChild);t.replaceWith(e),t=e}Array.from(t.children).forEach(Q)}let tt="html{background:#000;}\nbody{\n  background:#fff;\n  padding: 4ch;\n  max-width: 64ch;\n  margin:2ch auto;\n  white-space: pre-wrap;\n  border-radius: 5px;\n  font-family: monospace;\n  font-size: 100%;\n}\ntable{border-collapse: collapse;}\ntd{border: 1px solid #808080;}";function et(){let t=e.name_to_save_as.value.trim();return 0==t.length&&(t="index"),t}async function rt(t){let e=t.filter((t=>!g0.boxes_with_ocr_text.has(t)&&"true"!==t.dataset?.should_not_ocr&&0==t.textContent.trim().length));await g(e)}function nt(){return et()+" "+X()}async function ot(t=nt()){let r=w([...e.html_draw_over.getElementsByTagName("table")]);if(0==r.length)return[];let n=[];r.forEach((t=>{n.push(...b(t))})),await rt(n);let o=[];return r.forEach(((e,r)=>{let n=function(t){"string"==typeof t&&(t=(new DOMParser).parseFromString(t,"text/html"));return[...t.querySelectorAll("tr")].map((t=>[...t.querySelectorAll("td, th")].map((t=>t.textContent.trim()))))}(e),a=`${t} table_${r+1}`;o.push({name:a+".json",data:JSON.stringify(n,null,"\t")}),o.push({name:a+".csv",data:i(n)})})),o;function i(t){if(0===t.length)return"";const e=t=>{const e=(t+"").replaceAll("\n","\\n"),r=e.includes('"'),n=e.includes(","),o=r||n,i=r?e.replace(/"/g,'""'):e;return o?`"${i}"`:i};return t.map((t=>t.map(e).join(","))).join("\n")}}function it(t,e=g0.live_box){e&&(e.style.textAlign={l:"left",c:"center",r:"right"}[t])}A("click",(function(){let t=nt();ot(t).then((e=>{if(0===e.length)return j("No tables in document");L($(e),t+" Tables.tar"),j("Saved Table Files")}))}),e.save_tables),e.do_not_ocr_this_box_checkbox.onchange=()=>{if(!g0.live_box)return;let t=e.do_not_ocr_this_box_checkbox.checked;g0.live_box.dataset.should_not_ocr=t?"true":"",t&&e.html_draw_over.insertBefore(g0.live_box,e.html_draw_over.firstChild)},e.align_text_left_radio.onclick=()=>{it("l")},e.align_text_center_radio.onclick=()=>{it("c")},e.align_text_right_radio.onclick=()=>{it("r")},g0.live_box=document.querySelector(".selected"),g0.live_box&&U()};window.addEventListener("load",(()=>{chop(Tesseract)}));</script></body></html>